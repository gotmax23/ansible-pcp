# SPDX-License-Identifier: MIT
---
- name: Check if elasticsearch PMDA is installed in the filesystem
  command: test -d "/var/lib/pcp/pmdas/elasticsearch"

- name: Check if elasticsearch PMDA is registered with pmcd
  shell: |-
    set -euo pipefail
    pmprobe -I pmcd.agent.status | grep '"elasticsearch"'
  register: result
  until: result.stdout.find("elasticsearch") != -1
  retries: 10
  delay: 1
